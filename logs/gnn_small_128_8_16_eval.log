2025-03-20 18:09:11,992 - model_evaluation - INFO - Starting evaluation of model from directory: interp_checkpoints/bellman_ford/gnn_small_all
2025-03-20 18:09:11,992 - model_evaluation - INFO - Using config file: interp_checkpoints/bellman_ford/gnn_small_all/gnn_small_all_config.json
2025-03-20 18:09:11,992 - model_evaluation - INFO - Using checkpoint file: interp_checkpoints/bellman_ford/gnn_small_all/gnn_small_all.pth
2025-03-20 18:09:11,992 - model_evaluation - INFO - Algorithm: bellman_ford
2025-03-20 18:09:11,992 - model_evaluation - INFO - Device: cpu
2025-03-20 18:09:11,992 - model_evaluation - INFO - Batch size: 32
2025-03-20 18:09:11,992 - model_evaluation - INFO - Inferred OOD dataset path: ./data/bellman_ford/interp_data_OOD_eval.h5
2025-03-20 18:09:11,992 - model_evaluation - INFO - Creating model from configuration...
2025-03-20 18:09:11,995 - model_evaluation - INFO - Confirmed model is a single algorithm model
2025-03-20 18:09:11,995 - model_evaluation - INFO - Model metadata:
2025-03-20 18:09:11,995 - model_evaluation - INFO -   Model Type: gnn
2025-03-20 18:09:11,995 - model_evaluation - INFO -   Learning rate: 0.0005
2025-03-20 18:09:11,998 - model_evaluation - INFO - Model weights loaded successfully
2025-03-20 18:09:11,998 - model_evaluation - INFO - Evaluating model on bellman_ford OOD dataset...
Found config file: interp_checkpoints/bellman_ford/gnn_small_all/gnn_small_all_config.json
Found checkpoint file: interp_checkpoints/bellman_ford/gnn_small_all/gnn_small_all.pth
Using specified algorithm: bellman_ford
Results will be saved to: interp/results/gnn_small_all_20250320_180911
Evaluating:   0%|          | 0/3 [00:00<?, ?it/s]Evaluating:  33%|███▎      | 1/3 [00:00<00:01,  1.01it/s]Evaluating:  67%|██████▋   | 2/3 [00:01<00:00,  1.05it/s]Evaluating: 100%|██████████| 3/3 [00:02<00:00,  1.77it/s]Evaluating: 100%|██████████| 3/3 [00:02<00:00,  1.49it/s]
2025-03-20 18:09:14,036 - model_evaluation - INFO - Evaluation completed successfully
2025-03-20 18:09:14,036 - model_evaluation - INFO - === Evaluation Results ===
2025-03-20 18:09:14,036 - model_evaluation - INFO - loss: 0.117621
2025-03-20 18:09:14,036 - model_evaluation - INFO - class_accuracy: 0.959922
2025-03-20 18:09:14,036 - model_evaluation - INFO - class_precision: 0.956169
2025-03-20 18:09:14,036 - model_evaluation - INFO - class_recall: 0.959741
2025-03-20 18:09:14,036 - model_evaluation - INFO - class_f1: 0.957801
2025-03-20 18:09:14,036 - model_evaluation - INFO - dist_mae: 0.336265
2025-03-20 18:09:14,036 - model_evaluation - INFO - dist_mse: 0.2125694751739502
2025-03-20 18:09:14,036 - model_evaluation - INFO - dist_mae_correct_pi: 0.346758
2025-03-20 18:09:14,036 - model_evaluation - INFO - dist_mae_incorrect_pi: 0.084945
2025-03-20 18:09:14,036 - model_evaluation - INFO - dist_mae_self_pi: 0.680085
2025-03-20 18:09:14,036 - model_evaluation - INFO - dist_mae_nonself_pi: 0.331397
2025-03-20 18:09:14,037 - model_evaluation - INFO - Metrics saved to: interp/results/gnn_small_all_20250320_180911/bellman_ford/metrics.yaml
2025-03-20 18:09:14,417 - model_evaluation - INFO - Visualization saved to: interp/results/gnn_small_all_20250320_180911/bellman_ford/metrics_visualization.png
2025-03-20 18:09:14,417 - model_evaluation - INFO - Evaluation completed. All results saved to interp/results/gnn_small_all_20250320_180911
Evaluation results for bellman_ford:
  loss: 0.1176
  class_accuracy: 0.9599
  class_precision: 0.9562
  class_recall: 0.9597
  class_f1: 0.9578
  dist_mae: 0.3363
  dist_mse: 0.2125694751739502
  dist_mae_correct_pi: 0.3468
  dist_mae_incorrect_pi: 0.0849
  dist_mae_self_pi: 0.6801
  dist_mae_nonself_pi: 0.3314
Results saved to interp/results/gnn_small_all_20250320_180911
